test_that("runDySim produces correct output for P: L-APIM and S: L-APIM", {
  popModList.apim <- list(nItemsX = 5,
                          loadValuesX_A = "moderate", loadValuesX_B = "moderate",
                          residCorrValuesX = "moderate", iccX = "weak",
                          nItemsY = 5,
                          loadValuesY_A = "weak", loadValuesY_B = "mixed",
                          residCorrValuesY = "mixed", iccY = "strong",
                          actorA = "moderate", actorB = "very strong",
                          partnerA = "weak", partnerB = "weak")
  set.seed(123)
  expect_equal(runDySim(seed = 123,
                        popMod = "L-APIM",
                        popModList = popModList.apim,
                        sampSize = 100,
                        sampMod = "APIM",
                        sampModType = "latent",
                        nSims = 2,
                        output = "paramTable")$sim.dat,
               structure(list(pop_model = c("L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                            "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                            "L-APIM"), samp_model = c("L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                                                      "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                                                      "L-APIM"), samp_n = c(100, 100, 100, 100, 100, 100, 100, 100,
                                                                                            100, 100, 100, 100), lhs = c("YA", "YB", "YA", "YB", "k1", "k2",
                                                                                                                         "YA", "YB", "YA", "YB", "k1", "k2"), op = c("~", "~", "~", "~",
                                                                                                                                                                     ":=", ":=", "~", "~", "~", "~", ":=", ":="), rhs = c("XA", "XB",
                                                                                                                                                                                                                          "XB", "XA", "p1/a1", "p2/a2", "XA", "XB", "XB", "XA", "p1/a1",
                                                                                                                                                                                                                          "p2/a2"), label = c("a1", "a2", "p1", "p2", "k1", "k2", "a1",
                                                                                                                                                                                                                                              "a2", "p1", "p2", "k1", "k2"), est = c(-0.0549120119229995, 0.415750311284535,
                                                                                                                                                                                                                                                                                     -0.0142349924319804, 0.069289969045606, 0.259232760437579, 0.166662458607721,
                                                                                                                                                                                                                                                                                     0.150800347632958, 0.480510269812234, -0.161639408319174, -0.0848906409074196,
                                                                                                                                                                                                                                                                                     -1.07187689455861, -0.176667693160006), se = c(0.139935080053524,
                                                                                                                                                                                                                                                                                                                                    0.148767085894018, 0.140215778991522, 0.144132567827298, 2.4711018565607,
                                                                                                                                                                                                                                                                                                                                    0.335998941327079, 0.136442590105336, 0.145426235779743, 0.136030380932957,
                                                                                                                                                                                                                                                                                                                                    0.139419075601121, 1.17631023711616, 0.283588486322321), z = c(-0.392410622854514,
                                                                                                                                                                                                                                                                                                                                                                                                   2.79463907480661, -0.101522043627066, 0.480737768639704, 0.1049057365844,
                                                                                                                                                                                                                                                                                                                                                                                                   0.496020784915162, 1.10522929472782, 3.30415118864794, -1.18825961678986,
                                                                                                                                                                                                                                                                                                                                                                                                   -0.608888278317757, -0.911219558189361, -0.622972023480563),
                              pvalue = c(0.694754838305126, 0.00519576869796778, 0.919136059676198,
                                         0.630702884457495, 0.916450606952826, 0.619879746542468,
                                         0.269060246213779, 0.00095264441940146, 0.234731142487561,
                                         0.542598494261072, 0.362179700880569, 0.533302906533279),
                              ci.lower = c(-0.329179729001635, 0.124172180847282, -0.289052869319592,
                                           -0.213204672895174, -4.58403788055145, -0.49188336523694,
                                           -0.116622214930862, 0.195480085276707, -0.428254055751035,
                                           -0.358147007843483, -3.37740259395206, -0.732490912781984
                              ), ci.upper = c(0.219355705155636, 0.707328441721788, 0.260582884455631,
                                              0.351784610986386, 5.10250340142661, 0.825208282452382, 0.418222910196778,
                                              0.765540454347761, 0.104975239112686, 0.188365726028644,
                                              1.23364880483484, 0.379155526461972), std.lv = c(-0.0548298953988842,
                                                                                               0.38443903980286, -0.0142137051387564, 0.0640715555583362,
                                                                                               0.259232760437579, 0.166662458607721, 0.147949777516309,
                                                                                               0.434779758571094, -0.158583948074818, -0.0768115369794196,
                                                                                               -1.07187689455861, -0.176667693160006), std.all = c(-0.0548298953988842,
                                                                                                                                                   0.38443903980286, -0.0142137051387564, 0.0640715555583362,
                                                                                                                                                   0.259232760437579, 0.166662458607721, 0.147949777516309,
                                                                                                                                                   0.434779758571094, -0.158583948074818, -0.0768115369794196,
                                                                                                                                                   -1.07187689455861, -0.176667693160006), std.nox = c(-0.0548298953988842,
                                                                                                                                                                                                       0.38443903980286, -0.0142137051387564, 0.0640715555583362,
                                                                                                                                                                                                       0.259232760437579, 0.166662458607721, 0.147949777516309,
                                                                                                                                                                                                       0.434779758571094, -0.158583948074818, -0.0768115369794196,
                                                                                                                                                                                                       -1.07187689455861, -0.176667693160006)), row.names = c(NA,
                                                                                                                                                                                                                                                              -12L), class = c("lavaan.data.frame", "data.frame")))
})

test_that("runDySim produces correct output for P: L-APIM and S: L-APIM", {
  popModList.apim <- list(nItemsX = 5,
                          loadValuesX_A = "moderate", loadValuesX_B = "moderate",
                          residCorrValuesX = "moderate", iccX = "weak",
                          nItemsY = 5,
                          loadValuesY_A = "weak", loadValuesY_B = "mixed",
                          residCorrValuesY = "mixed", iccY = "strong",
                          actorA = "moderate", actorB = "very strong",
                          partnerA = "weak", partnerB = "weak")
  set.seed(123)
  expect_equal(runDySim(seed = 123,
                        popMod = "L-APIM",
                        popModList = popModList.apim,
                        sampSize = 100,
                        sampMod = "APIM",
                        sampModType = "observed",
                        nSims = 2,
                        output = "paramTable")$sim.dat,
               structure(list(pop_model = c("L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                            "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM", "L-APIM",
                                            "L-APIM"), samp_model = c("O-APIM", "O-APIM", "O-APIM", "O-APIM",
                                                                      "O-APIM", "O-APIM", "O-APIM", "O-APIM", "O-APIM", "O-APIM", "O-APIM",
                                                                      "O-APIM"), samp_n = c(100, 100, 100, 100, 100, 100, 100, 100,
                                                                                            100, 100, 100, 100), lhs = c("Y_A", "Y_B", "Y_A", "Y_B", "k1",
                                                                                                                         "k2", "Y_A", "Y_B", "Y_A", "Y_B", "k1", "k2"), op = c("~", "~",
                                                                                                                                                                               "~", "~", ":=", ":=", "~", "~", "~", "~", ":=", ":="), rhs = c("X_A",
                                                                                                                                                                                                                                              "X_B", "X_B", "X_A", "p1/a1", "p2/a2", "X_A", "X_B", "X_B", "X_A",
                                                                                                                                                                                                                                              "p1/a1", "p2/a2"), label = c("a1", "a2", "p1", "p2", "k1", "k2",
                                                                                                                                                                                                                                                                           "a1", "a2", "p1", "p2", "k1", "k2"), est = c(-0.0306934264880345,
                                                                                                                                                                                                                                                                                                                        0.250325728848689, -0.0602157802670168, -0.034618197089765, 1.96184613961205,
                                                                                                                                                                                                                                                                                                                        -0.138292604795291, -0.0111344804747976, 0.0820135266464922,
                                                                                                                                                                                                                                                                                                                        -0.00700001507052656, 0.0726497142052773, 0.628679091617321,
                                                                                                                                                                                                                                                                                                                        0.885825999391828), se = c(0.0749655317692394, 0.105120664405426,
                                                                                                                                                                                                                                                                                                                                                   0.0798462870515836, 0.098694965014434, 5.42862326489595, 0.399111872903358,
                                                                                                                                                                                                                                                                                                                                                   0.0815460202567115, 0.10121443034573, 0.0826711729823848, 0.0998369043221762,
                                                                                                                                                                                                                                                                                                                                                   9.64926713247997, 1.82490124833162), z = c(-0.409433852647317,
                                                                                                                                                                                                                                                                                                                                                                                              2.38131798599789, -0.754146278938621, -0.350759505155122, 0.361389259095999,
                                                                                                                                                                                                                                                                                                                                                                                              -0.346500853981805, -0.136542291576531, 0.810294800517563, -0.0846729859756326,
                                                                                                                                                                                                                                                                                                                                                                                              0.727683963144879, 0.0651530404315528, 0.48541037505546), pvalue = c(0.682221300660965,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.0172508135059055, 0.450761391067677, 0.725768779500888, 0.717808476234153,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.728966342531171, 0.891392593752607, 0.417770762974235, 0.932521372889547,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.466807069457751, 0.948052149947415, 0.627385274254103), ci.lower = c(-0.177623168837637,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.0442930125831323, -0.216711627187368, -0.228056773973496, -8.67805994522024,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -0.920537501488201, -0.170961743260526, -0.116363111546877, -0.169032536675681,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -0.123027022594159, -18.2835369652495, -2.69091472268033), ci.upper = c(0.116236315861568,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.456358445114245, 0.096280066653334, 0.158820379793966, 12.6017522244443,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.643952291897618, 0.148692782310931, 0.280390164839861, 0.155032506534628,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.268326451004714, 19.5408951484841, 4.46256672146398), std.lv = c(-0.0306934264880345,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.250325728848689, -0.0602157802670168, -0.034618197089765, 1.96184613961205,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -0.138292604795291, -0.0111344804747976, 0.0820135266464922,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -0.00700001507052656, 0.0726497142052773, 0.628679091617321,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.885825999391828), std.all = c(-0.0407969038132327, 0.231512228763917,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -0.0751448201071653, -0.0341009118799235, 1.84192458455124, -0.147296374200162,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -0.0140827242288128, 0.0829377529057769, -0.00873301815398797,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.0744821177308027, 0.620122783922766, 0.898048417292179), std.nox = c(-0.0407969038132327,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0.231512228763917, -0.0751448201071653, -0.0341009118799235,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1.84192458455124, -0.147296374200162, -0.0140827242288128, 0.0829377529057769,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -0.00873301815398797, 0.0744821177308027, 0.620122783922766,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0.898048417292179)), row.names = c(NA, -12L), class = c("lavaan.data.frame",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "data.frame")))
})
